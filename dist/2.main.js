(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[,function(e,t,n){"use strict";n.r(t);var r=n(3);let i={},o=function(e,t){return new Promise((n,r)=>{e.load(t,e=>{n(e)},(e,t)=>{console.log(`Loading: ${t/e*100}%`)},e=>{r(`Failed to load ${t}`)})})};var a=n(11),s=n(5);const u=document.getElementById("heightmap");function c(e,t){this.scale=.5,this.geometry=new r.o(1,1,e,e),this.geometry.applyMatrix4((new r.j).makeRotationX(-Math.PI/2)),this.shader=new r.t({vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:r.e}),this.mesh=new r.k(this.geometry,this.shader),this.uniforms={worldLightPos:{value:new r.A(1,1,0).normalize()},lightCol:{value:new r.d(1,1,.9)},scale:{value:this.scale},heightmap:{type:"t",value:this.texture},flatmap:{type:"t",value:i.grass},edgemap:{type:"t",value:i.rock}},this.mesh.material.uniforms=this.uniforms,this.mesh.onAfterRender(()=>{this.mesh.material.uniforms.inverseModelMatrix.value=this.mesh.matrixWorld.getInverse(this.mesh.matrixWorld)})}function l(e){let t=new r.z(0,0);e.getSize(t),e.setClearColor(new r.d(1,1,1),1),this.renderer=e,this.scene=new r.s,this.camera=new r.m(70,t.x/t.y,.01,10),this.control=new s.a(this.camera,e.domElement)}function d(e,t,n){return this.renderer=new r.D({canvas:e,antialias:!0}),this.renderer.setSize(t,n),this.renderer}c.prototype.get_mesh=function(){return this.mesh},c.prototype.update_texture=function(){this.mesh.material.uniforms.heightmap.value=new r.b(u)},l.prototype.init=function(){this.camera.position.set(0,.3,1),this.control.update(),this.terrainBuilder=new c(512,document.getElementById("heightmap"));let e=new r.a(.2,.2,.2),t=new r.l;var n=new r.o(1,1),o="#00eeff",s=4,u=1,l=1;this.water=new a.a(n,{normalMap0:i.water_normal_01,normalMap1:i.water_normal_02,color:o,scale:s,flowDirection:new r.z(u,l),textureWidth:1024,textureHeight:1024}),this.water.position.y=.1,this.water.rotation.x=-.5*Math.PI,this.box=new r.k(e,t),this.scene.add(this.camera),this.scene.add(this.water),this.scene.add(this.terrainBuilder.get_mesh())},l.prototype.draw=function(e){this.control.update(),this.renderer.render(this.scene,this.camera)},l.prototype.resize=function(){let e=new r.z(0,0);this.renderer.getSize(e),this.camera.aspect=e.x/e.y,this.camera.updateProjectionMatrix()};var h=n(2);const f=document.getElementById("window"),m=document.getElementById("close_settings"),w=document.getElementById("open_settings"),g=document.getElementById("canvas"),p=document.getElementById("heightmap").getContext("2d"),S=document.getElementById("tr_water"),y=document.getElementById("tr_height"),v=document.getElementById("gen_hm");m.addEventListener("click",()=>{k()}),w.addEventListener("click",()=>{k()}),v.addEventListener("click",()=>{B()}),y.addEventListener("input",()=>{let e=y.value/1e3;_.terrainBuilder.get_mesh().material.uniforms.scale.value=e}),addEventListener("input",()=>{let e=S.value/1e3;_.water.position.y=e});let E,_,x,A=window.innerWidth,b=window.innerHeight;!async function(e){let t=new r.w;this.ASSETS.vertexShader=await(await fetch("shaders/vert.glsl")).text(),this.ASSETS.fragmentShader=await(await fetch("shaders/frag.glsl")).text(),this.ASSETS.heightmap=await o(t,"assets/heightmap.png"),this.ASSETS.grass=await o(t,"assets/grass.jpg"),this.ASSETS.rock=await o(t,"assets/rock.jpg"),this.ASSETS.water_normal_01=await o(t,"assets/Water_1_M_Normal.jpg"),this.ASSETS.water_normal_02=await o(t,"assets/Water_2_M_Normal.jpg"),this.ASSETS.heightmap.wrapS=r.r,this.ASSETS.heightmap.wrapT=r.r,this.ASSETS.grass.wrapS=r.r,this.ASSETS.grass.wrapT=r.r,this.ASSETS.rock.wrapS=r.r,this.ASSETS.rock.wrapT=r.r,e()}(()=>{console.log("Finished loading resources!"),T()});const T=function(){x=new d(g,A,b),_=new l(x),_.init(),B(),E=Date.now(),requestAnimationFrame(I)},I=()=>{let e=Date.now(),t=(e-E)/1e3;E=e,_.draw(t),requestAnimationFrame(I)},B=()=>{const e=document.getElementById("hm_size").value,t=document.getElementById("hm_freq").value,n=document.getElementById("hm_oct").value,r=e,i=e;console.log(`${r}, ${i}`);let o=new Uint8ClampedArray(r*i*4);Object(h.m)(r,i,t,n,o);let a=new ImageData(o,r,i);p.putImageData(a,0,0),_.terrainBuilder.update_texture()},k=()=>{f.hasAttribute("closed")?f.removeAttribute("closed"):f.setAttribute("closed","true")};window.onresize=()=>{A=window.innerWidth,b=window.innerHeight,x.setSize(A,b),_.resize()}},function(e,t,n){"use strict";n.d(t,"m",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"l",(function(){return E})),n.d(t,"g",(function(){return _})),n.d(t,"e",(function(){return x})),n.d(t,"i",(function(){return A})),n.d(t,"h",(function(){return b})),n.d(t,"b",(function(){return T})),n.d(t,"k",(function(){return I})),n.d(t,"d",(function(){return B})),n.d(t,"f",(function(){return k})),n.d(t,"j",(function(){return z})),n.d(t,"c",(function(){return M}));var r=n(9);const i=new Array(32);function o(e){return i[e]}i.fill(void 0),i.push(void 0,null,!0,!1);let a=i.length;function s(e){const t=o(e);return function(e){e<36||(i[e]=a,a=e)}(e),t}let u=new("undefined"==typeof TextDecoder?n(4).TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});u.decode();let c=null;function l(){return null!==c&&c.buffer===r.f.buffer||(c=new Uint8Array(r.f.buffer)),c}function d(e,t){return u.decode(l().subarray(e,e+t))}let h=0;function f(e,t,n,i,o){try{var a=function(e,t){const n=t(1*e.length);return l().set(e,n/1),h=e.length,n}(o,r.c),s=h;r.g(e,t,n,i,a,s)}finally{o.set(l().subarray(a/1,a/1+s)),r.b(a,1*s)}}function m(e){a===i.length&&i.push(i.length+1);const t=a;return a=i[t],i[t]=e,t}function w(e,t){return l().subarray(e/1,e/1+t)}let g=new("undefined"==typeof TextEncoder?n(4).TextEncoder:TextEncoder)("utf-8");const p="function"==typeof g.encodeInto?function(e,t){return g.encodeInto(e,t)}:function(e,t){const n=g.encode(e);return t.set(n),{read:e.length,written:n.length}};let S=null;function y(){return null!==S&&S.buffer===r.f.buffer||(S=new Int32Array(r.f.buffer)),S}const v=function(e,t){alert(d(e,t))},E=function(e){s(e)},_=function(e,t,n){o(e).randomFillSync(w(t,n))},x=function(e,t,n){o(e).getRandomValues(w(t,n))},A=function(){try{return m(self.self)}catch(e){!function(e){r.a(m(e))}(e)}},b=function(e,t){return m(n(10)(d(e,t)))},T=function(e){return m(o(e).crypto)},I=function(e){return void 0===o(e)},B=function(e){return m(o(e).getRandomValues)},k=function(){return m(new Error)},z=function(e,t){var n=function(e,t,n){if(void 0===n){const n=g.encode(e),r=t(n.length);return l().subarray(r,r+n.length).set(n),h=n.length,r}let r=e.length,i=t(r);const o=l();let a=0;for(;a<r;a++){const t=e.charCodeAt(a);if(t>127)break;o[i+a]=t}if(a!==r){0!==a&&(e=e.slice(a)),i=n(i,r,r=a+3*e.length);const t=l().subarray(i+a,i+r);a+=p(e,t).written}return h=a,i}(o(t).stack,r.c,r.d),i=h;y()[e/4+1]=i,y()[e/4+0]=n},M=function(e,t){try{console.error(d(e,t))}finally{r.b(e,t)}}},,,,,,,function(e,t,n){"use strict";var r=n.w[e.i];e.exports=r;n(2);r.h()},function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=10}]]);